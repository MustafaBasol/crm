import{v as s,m as e,N as n}from"./index-CB_hoWrV.js";function U(){const[d,b]=s.useState(null),[T,y]=s.useState(!1),[o,l]=s.useState(!1),[p,r]=s.useState(null),[u,t]=s.useState(null),[h,k]=s.useState(""),[v,j]=s.useState(""),[c,f]=s.useState(""),[w,N]=s.useState(""),[x,A]=s.useState(""),[S,F]=s.useState(!1),[g,C]=s.useState(null),m=async()=>{try{y(!0);const a=await n.getSecurityConfig();b(a),j(a?.username||""),r(null)}catch(a){r(a?.response?.data?.message||a?.message||"GÃ¼venlik ayarlarÄ± yÃ¼klenemedi")}finally{y(!1)}};s.useEffect(()=>{m()},[]);const z=async a=>{if(a.preventDefault(),c&&c!==w){r("Yeni ÅŸifreler eÅŸleÅŸmiyor");return}try{l(!0),r(null);const i=await n.updateAdminCredentials({currentPassword:h,newUsername:v||void 0,newPassword:c||void 0});t("Bilgiler gÃ¼ncellendi"),setTimeout(()=>t(null),2500),k(""),f(""),N(""),await m()}catch(i){r(i?.response?.data?.message||i?.message||"GÃ¼ncelleme baÅŸarÄ±sÄ±z")}finally{l(!1)}},P=async()=>{try{l(!0),r(null);const a=await n.twoFASetup();b(i=>i&&{...i,twoFactorProvisioning:a}),F(!0),t("Authenticator uygulamasÄ±yla QR kodu tarayÄ±n ve kodu doÄŸrulayÄ±n"),setTimeout(()=>t(null),3e3)}catch(a){r(a?.response?.data?.message||a?.message||"2FA baÅŸlatÄ±lamadÄ±")}finally{l(!1)}},D=async()=>{try{l(!0),r(null);const a=await n.twoFAVerify({token:x});Array.isArray(a?.recoveryCodes)&&a.recoveryCodes.length>0?(t("2FA etkinleÅŸtirildi. Kurtarma kodlarÄ±nÄ±zÄ± gÃ¼venli bir yere kaydedin."),C(a.recoveryCodes)):t("2FA etkinleÅŸtirildi"),setTimeout(()=>t(null),2500),F(!1),A(""),await m()}catch(a){r(a?.response?.data?.message||a?.message||"DoÄŸrulama baÅŸarÄ±sÄ±z")}finally{l(!1)}},K=async()=>{if(window.confirm("2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±lsÄ±n mÄ±?"))try{l(!0),r(null),await n.twoFADisable(),t("2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"),setTimeout(()=>t(null),2500),await m()}catch(a){r(a?.response?.data?.message||a?.message||"2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±lamadÄ±")}finally{l(!1)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"ğŸ” Admin GÃ¼venlik"}),e.jsx("p",{className:"text-sm text-gray-600",children:"KullanÄ±cÄ± adÄ±nÄ±zÄ±, ÅŸifrenizi ve iki faktÃ¶rlÃ¼ kimlik doÄŸrulamayÄ± yÃ¶netin."})]}),p&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-700 rounded",children:p}),u&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 text-green-700 rounded",children:u}),e.jsxs("form",{onSubmit:z,className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"GiriÅŸ Bilgileri"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Mevcut Åifre"}),e.jsx("input",{type:"password",value:h,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Yeni KullanÄ±cÄ± AdÄ±"}),e.jsx("input",{type:"text",value:v,onChange:a=>j(a.target.value),className:"w-full px-3 py-2 border rounded-lg",placeholder:"BoÅŸ bÄ±rakÄ±rsanÄ±z deÄŸiÅŸmez"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Yeni Åifre"}),e.jsx("input",{type:"password",value:c,onChange:a=>f(a.target.value),className:"w-full px-3 py-2 border rounded-lg",placeholder:"BoÅŸ bÄ±rakÄ±rsanÄ±z deÄŸiÅŸmez"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Yeni Åifre (Tekrar)"}),e.jsx("input",{type:"password",value:w,onChange:a=>N(a.target.value),className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg disabled:opacity-50",children:"Kaydet"})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Ä°ki FaktÃ¶rlÃ¼ Kimlik DoÄŸrulama (2FA)"}),d?.twoFactorEnabled?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-green-700",children:"Durum: Etkin"}),e.jsx("button",{onClick:K,disabled:o,className:"px-4 py-2 bg-red-600 text-white rounded-lg disabled:opacity-50",children:"2FA'yÄ± devre dÄ±ÅŸÄ± bÄ±rak"}),Array.isArray(g)&&g.length>0&&e.jsxs("div",{className:"mt-3 bg-amber-50 border border-amber-200 rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-amber-800 mb-2",children:"Kurtarma KodlarÄ± (tek kullanÄ±mlÄ±k)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs text-amber-900",children:g.map(a=>e.jsx("code",{className:"px-2 py-1 bg-white border border-amber-300 rounded",children:a},a))}),e.jsx("div",{className:"text-xs text-amber-700 mt-2",children:"Bu kodlarÄ± gÃ¼venli bir yere kaydedin. Her biri sadece bir kez kullanÄ±labilir."})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Durum: Devre dÄ±ÅŸÄ±"}),S?e.jsxs("div",{className:"space-y-3",children:[d?.twoFactorProvisioning?.qrDataUrl&&e.jsx("img",{src:d.twoFactorProvisioning.qrDataUrl,alt:"2FA QR",className:"w-40 h-40"}),e.jsx("div",{className:"text-xs text-gray-600 break-all",children:d?.twoFactorProvisioning?.base32}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Authenticator Kodu"}),e.jsx("input",{value:x,onChange:a=>A(a.target.value),className:"px-3 py-2 border rounded-lg",placeholder:"123 456"})]}),e.jsx("button",{onClick:D,disabled:o||!x,className:"px-4 py-2 bg-green-600 text-white rounded-lg disabled:opacity-50",children:"DoÄŸrula ve EtkinleÅŸtir"})]}),u?.includes("Kurtarma kod")&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded p-3",children:[e.jsx("div",{className:"text-sm text-amber-800 font-medium mb-1",children:"Ã–NEMLÄ°: Kurtarma KodlarÄ±"}),e.jsx("div",{className:"text-xs text-amber-700",children:"DoÄŸrulamadan sonra ekranda gÃ¶sterilecek kurtarma kodlarÄ±nÄ± mutlaka gÃ¼venli bir yere kaydedin. Bu kodlar TOTP eriÅŸiminiz yokken giriÅŸ iÃ§in tek kullanÄ±mlÄ±ktÄ±r."})]})]}):e.jsx("button",{onClick:P,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg disabled:opacity-50",children:"2FA'yÄ± etkinleÅŸtir"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-2",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"GÃ¼venlik Ã–nerileri"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm text-gray-700 space-y-1",children:[e.jsx("li",{children:"ParolanÄ±zÄ± en az 12 karakter, karmaÅŸÄ±k bir kombinasyonla belirleyin."}),e.jsx("li",{children:"2FA'yÄ± etkinleÅŸtirip yedek kurtarma kodlarÄ±nÄ± gÃ¼venli yerde saklayÄ±n."}),e.jsx("li",{children:"Admin token'Ä± dÃ¼zenli aralÄ±klarla revoke edin ve yeniden giriÅŸ yapÄ±n."}),e.jsx("li",{children:"Ãœretimde dÃ¼z ÅŸifre yerine `ADMIN_PASSWORD_HASH` kullanÄ±n."})]})]})]})}export{U as default};
